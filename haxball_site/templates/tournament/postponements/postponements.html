{% extends "core/home.html" %}
{% load static %}
{% load tournament_extras %}


{% block title %}Чемпионат | Переносы          cis-haxball.com {% endblock %}

{% block profile_of_user %}
<link rel="stylesheet" type="text/css" href='{% static "tournament/postponements/postponements.css" %}'>
<div class="card mb-2 mt-2" style="border-radius: 10px; max-height: 700px;">
    <h2 class="text-center my-2">
        <i class="fa fa-calendar text-success" aria-hidden="true"></i> Переносы
    </h2>
    <div class="container-fluid p-0 mx-0">
        <form method="get">
            {{ filter.form }}
            <button style="visibility: none;">Применить фильтр</button>
        </form>
        <div class="table-fix table-responsive">
            <table class="table table-hover" style="max-width: 100%">
                <thead class="thead-dark py-2 text-center">
                    <tr>
                        <th scope="col" class="border-right">Команда</th>
                        <th scope="col">Перенос 1</th>
                        <th scope="col">Перенос 2</th>
                        <th scope="col">Перенос 3</th>
                        <th scope="col">Экстр. 1</th>
                        <th scope="col">Экстр. 2</th>
                        <th scope="col">Экстр. 3</th>
                    </tr>
                </thead>

                <tbody>
                    {% for team in teams %}
                        <tr style="font-weight: 700">
                            <td class="border-right" style="text-align: center; font-size: 15px; vertical-align: center;">
                                <img src="{{team.logo.url}}" alt="..." style="margin-right: 5px;" width="25" height="25">{{team.title}}
                            </td>
                            {% for postponement in team|postponements_in_leagues:filter.qs %}
                                <td class="border-right" style="font-size: 12px; text-align: center;" height="80px">
                                    {% if postponement is not None %}
                                        {% with match=postponement.match %}
                                            {{match.numb_tour.number}} тур<br>
                                            <a href="{{match.get_absolute_url}}">
                                                <img src="{{match.team_home.logo.url}}" alt="..." width="16" style="vertical-align: bottom;" height="16">
                                                {{match.team_home.short_title}} - {{match.team_guest.short_title}}
                                                <img src="{{match.team_guest.logo.url}}" style="vertical-align: bottom;" alt="..." width="16" height="16">
                                            </a><br>
                                            {{postponement.starts_at|date:'d.m'}}-{{postponement.ends_at|date:'d.m'}}
                                            {% if postponement|can_be_cancelled_by_user:user %}
                                                <a class="text-danger" data-toggle="modal"
                                                   data-target="#cancel_postponement{{ postponement.id }}">
                                                    <i class="fa fa-times" aria-hidden="true"
                                                       style="font-size: 14px; cursor: pointer"></i>
                                                </a>
                                                <div class="modal fade" id="cancel_postponement{{ postponement.id }}"
                                                     tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
                                                     aria-hidden="true">
                                                    <div class="modal-dialog">
                                                        <div class="modal-content">
                                                            <div class="modal-header justify-content-center">
                                                                <h4 class="modal-title">Отменить перенос?</h4>
                                                            </div>
                                                            <div class="modal-footer justify-content-center">
                                                                <button type="button" class="btn btn-danger"
                                                                        data-dismiss="modal">Нет, подождите
                                                                </button>
                                                                <form method="POST"
                                                                      action="{% url 'tournament:cancel_postponement' postponement.id %}">
                                                                    {% csrf_token %}
                                                                    <button type="submit"
                                                                            class="btn btn-primary">
                                                                        Да, я уверен
                                                                    </button>
                                                                </form>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            {% endif %}
                                        {% endwith %}
                                    {% endif %}
                                </td>
                            {% endfor %}
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

</div>

{% postponements_form user %}

{% endblock %}

